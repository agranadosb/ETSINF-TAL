(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42633,       1190]
NotebookOptionsPosition[     41478,       1149]
NotebookOutlinePosition[     41811,       1164]
CellTagsIndexPosition[     41768,       1161]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"CP", "[", "M_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", "i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"{", 
       RowBox[{"{", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "M", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"Length", "[", 
            RowBox[{"M", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"res", ",", 
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"M", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "j"}], "}"}]}], "]"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Union", "[", "res", "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.751185922090107*^9, 3.7511859706252947`*^9}, {
  3.751186098516481*^9, 3.7511861822440243`*^9}, {3.751186224134653*^9, 
  3.751186249000898*^9}, {3.75118631462342*^9, 3.751186575988896*^9}, {
  3.751186699516795*^9, 3.7511867295780907`*^9}, {3.751187013680358*^9, 
  3.751187021781786*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CP", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "a", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "a"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "b", ",", "b", ",", "b"}], "}"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7511865844157887`*^9, 3.751186622404028*^9}, {
  3.751186843414228*^9, 3.751186913100832*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "a", "}"}], ",", 
   RowBox[{"{", "b", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a", ",", "a"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a", ",", "a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a", ",", "b", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a", ",", "b", ",", "b", ",", "b"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7511870030165777`*^9, 3.751187049832691*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"CS", "[", "M_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", "i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"{", 
       RowBox[{"{", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", 
        RowBox[{"Length", "[", "M", "]"}]}], ",", 
       RowBox[{"i", "\[GreaterEqual]", "1"}], ",", 
       RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"Length", "[", 
            RowBox[{"M", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"j", "\[GreaterEqual]", "1"}], ",", 
          RowBox[{"j", "--"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"res", ",", 
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"M", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"M", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Union", "[", "res", "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.751187254366786*^9, 3.751187326126115*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CS", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "a", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "a"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "b", ",", "b", ",", "b"}], "}"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.751187335655529*^9, 3.751187336176488*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "a", "}"}], ",", 
   RowBox[{"{", "b", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", "a"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a", ",", "a"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "a"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", "a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", "b", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a", ",", "a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "b", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "a", ",", "b", ",", "b", ",", "b"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7511873370428257`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AAP", "[", "M_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "trans", ",", "estats", ",", "i", ",", "j", ",", "alf", ",", "aux", ",", 
      "finals"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"alf", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", "M", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"trans", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finals", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"estats", "=", 
      RowBox[{"CP", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "estats", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"Length", "[", "alf", "]"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"aux", "=", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"estats", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"alf", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"estats", ",", "aux"}], "]"}], ",", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"trans", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"estats", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"alf", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", "aux"}], "}"}]}], 
              "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"estats", ",", "alf", ",", "trans", ",", 
        RowBox[{"{", "}"}], ",", "M"}], "}"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7511874088534727`*^9, 3.7511874527638187`*^9}, {
  3.751187500592292*^9, 3.751187586678421*^9}, {3.751187665514267*^9, 
  3.751187681406451*^9}, {3.751187726812879*^9, 3.7511877431895113`*^9}, {
  3.7511878609980087`*^9, 3.7511881712452583`*^9}, {3.751188365476296*^9, 
  3.7511883656169653`*^9}, {3.751188433234943*^9, 3.7511884833036737`*^9}, {
  3.751188537548635*^9, 3.751188660917692*^9}}],

Cell[BoxData[
 RowBox[{"AAP", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "a", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "a"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "b", ",", "b", ",", "b"}], "}"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.751188116479261*^9, 3.751188116780863*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "a"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "b", ",", "b"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "a", ",", 
       RowBox[{"{", "a", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "a", "}"}], ",", 
          RowBox[{"{", "b", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "a"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "b"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "a", ",", "a"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", "b"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "a", ",", "a", ",", "b"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "a", ",", "b", ",", "b"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "b"}], "}"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"a", ",", "a", ",", "b", ",", "b", ",", "b"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", "a", ",", 
            RowBox[{"{", "a", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"b", 
             RowBox[{"{", "}"}]}], ",", "b", ",", 
            RowBox[{"{", "b", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", "a", ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "a"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", "b", ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "b"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "b", "}"}], ",", "b", ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "b"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a"}], "}"}], ",", "a", ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "a", ",", "a"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a"}], "}"}], ",", "b", ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "a", ",", "b"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "b"}], "}"}], ",", "b", ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "b", ",", "b"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a", ",", "a"}], "}"}], ",", "b", ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "a", ",", "a", ",", "b"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", "a", ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", "b", ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "a", ",", "b", ",", "b"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}], ",", "b", 
            ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "b"}], "}"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "a", ",", "b", ",", "b"}], "}"}], ",", "b", 
            ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "a", ",", "b", ",", "b", ",", "b"}], "}"}]}], 
           "}"}]}], "}"}], ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "a", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "b"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "a", ",", "a"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", "b"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "a", ",", "a", ",", "b"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "b"}], "}"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"a", ",", "a", ",", "b", ",", "b", ",", "b"}], "}"}]}], 
         "}"}]}], "}"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.751790499254156*^9, 3.751790499263214*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AFNAAP", "[", "M_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", "afn", ",", "alf", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"afn", "=", 
      RowBox[{"AAP", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"alf", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Flatten", "[", "M", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "alf", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{
          RowBox[{"afn", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"alf", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "afn", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.751188732384314*^9, 3.7511889184042377`*^9}, 
   3.751188959266992*^9, {3.751790523452381*^9, 3.751790537256452*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AFNAAP", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "a", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "a"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a", ",", "b", ",", "b", ",", "b"}], "}"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{3.751188927678988*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", "b", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "a"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "b", ",", "b"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "a", ",", 
       RowBox[{"{", "a", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "b", ",", 
       RowBox[{"{", "b", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", "a", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "b", "}"}], ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "b"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "a"}], "}"}], ",", "a", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "a"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "a"}], "}"}], ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "b"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "b"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "a"}], "}"}], ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "a", ",", "b"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", "a", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "b", ",", "b"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}], ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "b"}], "}"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "b", ",", "b"}], "}"}], ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "b", ",", "b", ",", "b"}], "}"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "a", ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "b", ",", 
       RowBox[{"{", "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "a"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "b", ",", "b"}], "}"}]}], "}"}]}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.751188962981675*^9, {3.7517905109172697`*^9, 3.751790540206575*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ej5", "[", 
   RowBox[{"AFN_", ",", "cad_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "j", ",", "t", ",", "trans", ",", "estatsActuals", ",", 
      "finals", ",", "aux", ",", "tt"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"trans", "=", 
      RowBox[{"AFN", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"estatsActuals", "=", 
      RowBox[{"{", 
       RowBox[{"AFN", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finals", "=", 
      RowBox[{"AFN", "[", 
       RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "cad", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"aux", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"Length", "[", "estatsActuals", "]"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tt", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{"trans", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"estatsActuals", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"cad", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "_"}], "}"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"tt", "\[NotEqual]", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"t", "=", "1"}], ",", 
                RowBox[{"t", "\[LessEqual]", " ", 
                 RowBox[{"Length", "[", "tt", "]"}]}], ",", 
                RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"aux", ",", 
                  RowBox[{
                   RowBox[{"tt", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"estatsActuals", "=", "aux"}], ";"}]}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "estatsActuals", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"finals", ",", 
           RowBox[{"estatsActuals", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"Return", "[", "True", "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "False", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7517895441841583`*^9, 3.751789708690009*^9}, {
  3.751790018397519*^9, 3.75179038776609*^9}, {3.751790582911221*^9, 
  3.7517906026158447`*^9}, {3.7517906962417107`*^9, 3.751790705821697*^9}, {
  3.751790764647954*^9, 3.751790765485116*^9}, {3.7517909837788343`*^9, 
  3.75179103773904*^9}, {3.7517911442255487`*^9, 3.751791171183977*^9}, {
  3.751791313367012*^9, 3.751791407268379*^9}, {3.751791462009531*^9, 
  3.751791468150193*^9}, {3.751791669865765*^9, 3.7517917370599003`*^9}, {
  3.751791793462151*^9, 3.7517918058856688`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ej5", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "a"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "b", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "b", ",", "b", ",", "b"}], "}"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "a", ",", 
         RowBox[{"{", "a", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "b", ",", 
         RowBox[{"{", "b", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", "a", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "a", "}"}], ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "b", "}"}], ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "b"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", "a", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "a", ",", "a"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "a", ",", "b"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "b"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a", ",", "a"}], "}"}], ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "a", ",", "a", ",", "b"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", "a", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "a", ",", "b", ",", "b"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}], ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "b"}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a", ",", "b", ",", "b"}], "}"}], ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "a", ",", "b", ",", "b", ",", "b"}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "a", ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "b", ",", 
         RowBox[{"{", "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "a"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "a", ",", "b", ",", "b", ",", "b"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "b", ",", "b", ",", "a", ",", "a", ",", "a", ",", "b", ",", "a", ",", "b",
      ",", "b"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7517903917878237`*^9, 3.751790397788259*^9}, {
  3.751790557279965*^9, 3.751790572828486*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.751790573432188*^9, 3.751790718682272*^9, 3.751790767790022*^9, {
   3.751791043886464*^9, 3.751791048927182*^9}, {3.751791184850752*^9, 
   3.751791190551594*^9}, 3.7517913166401577`*^9, {3.751791381464217*^9, 
   3.751791409594543*^9}, 3.7517914803684893`*^9, 3.751791540453165*^9, 
   3.751791672562419*^9, {3.751791789246117*^9, 3.751791808923154*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.751790883786199*^9, 3.7517908933800173`*^9}, {
   3.7517909642495604`*^9, 3.751790968586134*^9}, {3.751791054810927*^9, 
   3.7517911122515087`*^9}, {3.751791196455521*^9, 3.751791256800756*^9}, 
   3.751791290801571*^9, {3.75179149891477*^9, 3.7517915015075274`*^9}, {
   3.751791840626218*^9, 3.751791842033681*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ej6", "[", 
   RowBox[{"M_", ",", "cad_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "j", ",", "t", ",", "x", ",", "trans", ",", "estatsActuals", 
      ",", "finals", ",", "aux", ",", "tt", ",", "res", ",", "AFN"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AFN", "=", 
      RowBox[{"AFNAAP", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"trans", "=", 
      RowBox[{"AFN", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"estatsActuals", "=", 
      RowBox[{"{", 
       RowBox[{"AFN", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finals", "=", 
      RowBox[{"AFN", "[", 
       RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "cad", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"aux", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"Length", "[", "estatsActuals", "]"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tt", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{"trans", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"estatsActuals", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"cad", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "_"}], "}"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"tt", "\[NotEqual]", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"t", "=", "1"}], ",", 
                RowBox[{"t", "\[LessEqual]", " ", 
                 RowBox[{"Length", "[", "tt", "]"}]}], ",", 
                RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"aux", ",", 
                  RowBox[{
                   RowBox[{"tt", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"estatsActuals", "=", "aux"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"x", "=", "1"}], ",", 
          RowBox[{"x", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "estatsActuals", "]"}]}], ",", 
          RowBox[{"x", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"finals", ",", 
              RowBox[{"estatsActuals", "[", 
               RowBox[{"[", "x", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"res", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"estatsActuals", "[", 
                 RowBox[{"[", "x", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "res", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.751791829702242*^9, 3.751791991646215*^9}, {
  3.7517920413389263`*^9, 3.751792092146779*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ej6", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "a"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "b", ",", "b"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
    "b", ",", "b", ",", "a", ",", "a", ",", "a", ",", "b", ",", "a", ",", "b",
      ",", "b"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.751792006538088*^9, 3.751792023272779*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "b"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"{", "a", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"{", "a", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "a"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", 
     RowBox[{"{", "a", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "a", ",", "b"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "a"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", 
     RowBox[{"{", "a", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "b"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "b"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "b"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.751792009523127*^9, 3.751792094029147*^9}}]
}, Open  ]]
},
WindowSize->{953, 998},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"10.4 for Linux x86 (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1775, 44, 209, "Input"],
Cell[CellGroupData[{
Cell[2358, 68, 855, 23, 55, "Input"],
Cell[3216, 93, 1018, 29, 55, "Output"]
}, Open  ]],
Cell[4249, 125, 1670, 43, 209, "Input"],
Cell[CellGroupData[{
Cell[5944, 172, 804, 22, 55, "Input"],
Cell[6751, 196, 1341, 39, 77, "Output"]
}, Open  ]],
Cell[8107, 238, 2778, 66, 297, "Input"],
Cell[10888, 306, 805, 22, 55, "Input"],
Cell[11696, 330, 6413, 174, 253, InheritFromParent],
Cell[18112, 506, 1373, 36, 187, "Input"],
Cell[CellGroupData[{
Cell[19510, 546, 784, 22, 55, "Input"],
Cell[20297, 570, 4662, 138, 187, "Output"]
}, Open  ]],
Cell[24974, 711, 4021, 92, 473, "Input"],
Cell[CellGroupData[{
Cell[29020, 807, 5143, 144, 187, "Input"],
Cell[34166, 953, 412, 6, 32, "Output"]
}, Open  ]],
Cell[34593, 962, 367, 5, 32, "Input"],
Cell[34963, 969, 4034, 96, 517, InheritFromParent],
Cell[CellGroupData[{
Cell[39022, 1069, 978, 27, 55, "Input"],
Cell[40003, 1098, 1459, 48, 55, "Output"]
}, Open  ]]
}
]
*)

